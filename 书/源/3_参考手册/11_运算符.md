# 运算符

歧语言的内置运算符:

+ 赋值
+ 中间运算符
+ 前运算符
+ 比较运算符

除了赋值, 歧语言的运算符其实都是函数。


## 运算符的优先级和结合性

小括号 `(` `)` 表示优先级最高的运算:
总是先计算小括号里面的表达式。

歧语言运算符的优先级取值范围 `0` ~ `255`, 其中 `0` 表示最高优先级。

歧语言的内置运算符具有默认优先级 (标准库定义), 改变运算符优先级详见 [自定义运算符](#自定义运算符)。

处理小括号之后, 优先级高的运算符先结合运算。
同级运算符从左至右依次运算。

由于运算符可以自定义, 运算符的优先级也可以自定义,
为了避免歧义 (不清楚先算哪个后算哪个), 建议多使用小括号。


## 内置: 赋值

赋值运算符。

| 运算符 | 默认优先级 | 说明 | 备注 |
| :----: | ---------: | :--- | :--- |
| `+=` | 100 | 加 (算术运算) 然后赋值 | |
| `-=` | 100 | 减 (算术运算) 然后赋值 | |
| `*=` | 100 | 乘 (算术运算) 然后赋值 | |
| `/=` | 100 | 除 (算术运算) 然后赋值 | |
| `%=` | 100 | 求余 (算术运算) 然后赋值 | |
| `&=` | 100 | 与 (位运算) 然后赋值 | |
| \|= | 100 | 或 (位运算) 然后赋值 | |
| `^=` | 100 | 异或 (位运算) 然后赋值 | |
| `<<=` | 100 | 向左位移 (位运算) 然后赋值 | |
| `>>=` | 100 | 向右位移 (位运算) 然后赋值 | |
| `>>>=` | 100 | 带符号向右位移 (位运算) 然后赋值 | (1) |

注:

+ (1) 只用于有符号整数。

赋值运算符的左侧为变量名 (或变量表达式), 右侧为表达式。
赋值运算符只能使用数字类型。
位运算只能用于整数。

含有赋值运算符的代码行是 `赋值语句`, 所以一行代码中最多只能出现一个赋值运算符。

赋值运算符是一种语法糖, 比如 `x += 1` 相当于 `x = x + 1`。


## 内置: 中间运算符

具有 `左`, `右` 两个参数。

| 运算符 | 默认优先级 | 说明 | 备注 |
| :----: | ---------: | :--- | :--- |
| `+` | 30 | 加 (算术运算) | |
| `-` | 30 | 减 (算术运算) | |
| `*` | 20 | 乘 (算术运算) | |
| `/` | 20 | 除 (算术运算) | |
| `%` | 20 | 求余 (算术运算) | |
| `&` | 60 | 与 (位运算) | (1) |
| \| | 60 | 或 (位运算) | (1) |
| `^` | 60 | 异或 (位运算) | (1) |
| `<<` | 20 | 向左位移 (位运算) | (1) |
| `>>` | 20 | 向右位移 (位运算) | (1) |
| `>>>` | 20 | 带符号向右位移 (位运算) | (1) (2) |

注:

+ (1) 位运算只能用于整数。

+ (2) 只能用于有符号整数。

这些运算符只能用于数字类型。

### 位运算函数表

此处介绍位运算的规则。

| 运算符 | 左 | 右 | 结果 | 备注 |
| :----: | -: | -: | ---: | :--- |
| `&` | 0 | 0 | 0 | |
| `&` | 0 | 1 | 0 | |
| `&` | 1 | 0 | 0 | |
| `&` | 1 | 1 | 1 | |
| \| | 0 | 0 | 0 | |
| \| | 0 | 1 | 1 | |
| \| | 1 | 0 | 1 | |
| \| | 1 | 1 | 1 | |
| `^` | 0 | 0 | 0 | |
| `^` | 0 | 1 | 1 | |
| `^` | 1 | 0 | 1 | |
| `^` | 1 | 1 | 0 | |

+ 与运算 (`&`): 全部输入为 `1` 结果才为 `1`。

+ 或运算 (`|`): 只要有一个输入为 `1` 结果就为 `1`。

+ 异或 (`^`): 相同为 `0`, 不同为 `1`。


## 内置: 前运算符

只有后面一个参数。

| 运算符 | 默认优先级 | 说明 | 备注 |
| :----- | ---------: | :--- | :--- |
| `+` | 10 | 正 (算术运算) | (1) |
| `-` | 10 | 负 (算术运算) | (1) |
| `~` | 10 | 非 (位运算) | (2) |

注:

+ (1) 只能用于数字。

+ (2) 只能用于整数。

### 位运算函数表

| 运算符 | 输入 | 结果 | 备注 |
| :----: | ---: | ---: | :--- |
| `~` | 0 | 1 | |
| `~` | 1 | 0 | |


## 内置: 比较运算符

具有 `左`, `右` 两个参数, 是一种特殊的中间运算符。

| 运算符 | 默认优先级 | 说明 | 备注 |
| :----: | ---------: | :--- | :--- |
| `==` | 50 | 相等 | (1) |
| `!=` | 50 | 不等 | (1) |
| `>` | 50 | 大于 | (2) |
| `<` | 50 | 小于 | (2) |
| `>=` | 50 | 大于或等于 | (2) |
| `<=` | 50 | 小于或等于 | (2) |

注:

+ (1) 只能用于比较两个相同数据类型的东西。
  如果数据类型不同, 需要先转换数据类型。

+ (2) 只能用于数字。

比较运算符 (函数) 的返回值类型是 `二` (`u1`)。


## 自定义运算符

内置运算符是定义在标准库中的函数 (默认导入), 比如:

```
定义*(数字), 参数左(数字)、右(数字), 标记内部, 标记运算符(20)。
```

由于函数的重载和覆盖特性 (详见 [函数](./8_函数.md)),
可以自定义新的运算符, 或者修改内置运算符的优先级。
